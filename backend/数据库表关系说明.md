# æ•°æ®åº“è¡¨å…³ç³»è¯´æ˜

## ğŸ“Š è¡¨å…³ç³»æ¦‚è§ˆ

æ•´ä½“ä¸Šå¯ä»¥åˆ†ä¸º **ä¸‰å±‚ç»“æ„**ï¼š

1. **äº¤æ˜“å±‚ï¼ˆæ ¸å¿ƒäº‹å®ï¼‰ï¼š** `orders`ã€`order_items`ã€`skus`
2. **ä¸šåŠ¡ç»´åº¦å±‚ï¼š** `customers`ã€`warehouses`ã€`vehicles`ã€`routes`ã€`route_stops`
3. **è§„åˆ’è¾“å…¥å±‚ï¼š** `planning_orders`

æ ¸å¿ƒå…³ç³»ç¤ºæ„ï¼š

```
äº¤æ˜“å±‚ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    skus     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”¤ order_items  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚   orders    â”‚
â”‚  (SKUè¡¨)    â”‚         â”‚  (è®¢å•æ˜ç»†è¡¨) â”‚         â”‚  (è®¢å•è¡¨)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     1                          N                         1

ç»´åº¦å±‚ï¼š
customers  â”€â”€<  orders   >â”€â”€  route_stops  >â”€â”€  routes  â”€â”€<  vehicles / warehouses

è§„åˆ’å±‚ï¼š
planning_orders  â‰ˆ  é¢å‘ç®—æ³•çš„æ‰å¹³åŒ–è®¢å•è§†å›¾ï¼ˆä» orders / customers èšåˆè€Œæ¥ï¼‰
```

## ğŸ“‹ è¡¨ç»“æ„è¯¦è§£

### 1. `skus` è¡¨ - SKUåŸºç¡€ä¿¡æ¯è¡¨ï¼ˆäº¤æ˜“å±‚ï¼‰

**ä½œç”¨**ï¼šå­˜å‚¨å•†å“ï¼ˆSKUï¼‰çš„åŸºç¡€ä¿¡æ¯ï¼Œå¦‚å°ºå¯¸ã€é‡é‡ã€å“ç±»ç­‰

**å­—æ®µè¯´æ˜ï¼ˆæ–°å¢å­—æ®µå·²åŠ ç²—ï¼‰**ï¼š
- `id` (ä¸»é”®) - è‡ªå¢ID
- `name` (å”¯ä¸€) - SKUåç§°ï¼Œå¦‚ "Tower_Fan_Pilot"
- `length` - é•¿åº¦ï¼ˆcmï¼‰
- `width` - å®½åº¦ï¼ˆcmï¼‰
- `height` - é«˜åº¦ï¼ˆcmï¼‰
- `weight` - é‡é‡ï¼ˆkgï¼‰
- **`category`** - å“ç±»ï¼ˆå¡”æ‰‡/æ–™ç†æœºç­‰ï¼‰
- **`volume_unit`** - ä½“ç§¯å•ä½ï¼ˆUNIT/CARTON/PALLETï¼‰
- **`pack_unit`** - åŒ…è£…å•ä½
- **`is_hazardous`** - æ˜¯å¦å±é™©å“
- **`temperature_zone`** - æ¸©åŒºï¼ˆAMBIENT/CHILL/FROZENï¼‰
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

**ç¤ºä¾‹æ•°æ®**ï¼š
```
id | name                | length | width | height | weight
---|---------------------|--------|-------|--------|-------
1  | Tower_Fan_Pilot     | 110    | 30    | 30     | 8.5
2  | Air_Fryer_Pro       | 40     | 35    | 35     | 6.0
3  | Heater_Solaris      | 25     | 25    | 60     | 4.2
```

### 2. `orders` è¡¨ - è®¢å•ä¸»è¡¨ï¼ˆäº¤æ˜“å±‚ï¼‰

**ä½œç”¨**ï¼šå­˜å‚¨è®¢å•çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚å®¢æˆ·ã€åæ ‡ã€æ€¥å•æ ‡è¯†ç­‰

**å­—æ®µè¯´æ˜ï¼ˆæ–°å¢å­—æ®µå·²åŠ ç²—ï¼‰**ï¼š
- `id` (ä¸»é”®) - è‡ªå¢IDï¼ˆæ•°æ®åº“å†…éƒ¨IDï¼‰
- `order_id` (å”¯ä¸€) - ä¸šåŠ¡è®¢å•å·ï¼Œå¦‚ "ORD-1000"
- `customer` - å®¢æˆ·åç§°ï¼ˆå†—ä½™å­—æ®µï¼Œæ–¹ä¾¿ç›´æ¥æŸ¥è¯¢ï¼‰
- **`customer_id`** - å¤–é”®ï¼Œå…³è” `customers.id`
- `rsd` - æ€¥å•æ ‡è¯†ï¼ˆ0=ä»Šå¤©æ€¥å•, 1=æ˜å¤©ï¼‰
- `location_x` - é…é€åæ ‡X
- `location_y` - é…é€åæ ‡Y
- `status` - è®¢å•çŠ¶æ€ï¼ˆpending, processed, completedï¼‰
- **`order_type`** - è®¢å•ç±»å‹ï¼ˆB2B / B2C / RETURNï¼‰
- **`priority`** - ä¼˜å…ˆçº§ï¼ˆæ•°å­—è¶Šå¤§è¶Šç´§æ€¥ï¼‰
- **`planned_ship_date`** - è®¡åˆ’å‘è¿æ—¥æœŸ
- **`promised_date`** - æ‰¿è¯ºåˆ°è¾¾æ—¥æœŸ
- **`ship_to_city` / `ship_to_country` / `ship_to_postal_code`** - æ›´ç»†ç²’åº¦çš„æ”¶è´§åœ°å€
- `created_at` - åˆ›å»ºæ—¶é—´
- `updated_at` - æ›´æ–°æ—¶é—´

**ç¤ºä¾‹æ•°æ®**ï¼š
```
id | order_id  | customer        | rsd | location_x | location_y | status
---|-----------|-----------------|-----|------------|------------|--------
1  | ORD-1000  | Walmart_DC_0    | 0   | 45         | 55         | pending
2  | ORD-1001  | BestBuy_Hub_1   | 0   | 60         | 70         | pending
3  | ORD-1002  | Target_DC_2     | 1   | 35         | 40         | pending
```

### 3. `order_items` è¡¨ - è®¢å•æ˜ç»†è¡¨ï¼ˆä¸­é—´è¡¨ï¼Œäº¤æ˜“å±‚ï¼‰

**ä½œç”¨**ï¼šè¿æ¥è®¢å•å’ŒSKUï¼Œå®ç°å¤šå¯¹å¤šå…³ç³»ï¼Œè®°å½•æ¯ä¸ªè®¢å•åŒ…å«å“ªäº›SKUåŠæ•°é‡

**å­—æ®µè¯´æ˜ï¼ˆæ–°å¢å­—æ®µå·²åŠ ç²—ï¼‰**ï¼š
- `id` (ä¸»é”®) - è‡ªå¢ID
- `order_id` (å¤–é”®) - å…³è” `orders.id`
- `sku_id` (å¤–é”®) - å…³è” `skus.id`
- `quantity` - å•†å“æ•°é‡
- **`unit_price`** - å•ä»·
- **`currency`** - å¸ç§
- **`line_no`** - è¡Œå·ï¼ˆå¯¹é½å¤–éƒ¨ OMSï¼‰
- `created_at` - åˆ›å»ºæ—¶é—´

### 4. `customers` è¡¨ - å®¢æˆ·ç»´åº¦è¡¨ï¼ˆç»´åº¦å±‚ï¼‰

**ä½œç”¨**ï¼šæ²‰æ·€å®¢æˆ·å±æ€§ï¼Œé¿å…åœ¨è®¢å•è¡¨é‡å¤å­˜å‚¨æ–‡æœ¬ä¿¡æ¯ã€‚

**å­—æ®µè¯´æ˜**ï¼š
- `id` - ä¸»é”®
- `code` - å®¢æˆ·ç¼–ç ï¼ˆOMS å®¢æˆ·å·ï¼‰
- `name` - å®¢æˆ·åç§°
- `city` / `country` / `postal_code` - åœ°å€ä¿¡æ¯
- `lat` / `lng` - åœ°ç†åæ ‡ï¼ˆå¯ç›´æ¥å–‚ç»™ VRPï¼‰
- `customer_type` - ç±»å‹ï¼ˆDC / STORE / HUB ç­‰ï¼‰

`orders.customer_id` â†’ `customers.id`ï¼šå¤šå¯¹ä¸€å…³ç³»ã€‚

### 5. `warehouses` / `vehicles` è¡¨ - ä»“ä¸è½¦è¾†ï¼ˆç»´åº¦å±‚ï¼‰

**`warehouses` è¡¨**ï¼š
- å­˜å‚¨ä»“åº“/è½¦åœºä¿¡æ¯ï¼ŒåŒ…å« code/name/city/country/lat/lng/is_active ç­‰ã€‚

**`vehicles` è¡¨**ï¼š
- è½¦è¾†èµ„æºç»´è¡¨ï¼Œå­—æ®µåŒ…å«ï¼š
  - `code`, `plate_no`
  - `capacity_pallets`, `capacity_weight`
  - `home_warehouse_id`ï¼ˆå¤–é”®ï¼Œå…³è” `warehouses.id`ï¼‰
  - `region`, `cost_per_km`, `is_active`

è¿™äº›è¡¨ä¸ºåç»­å¤šè½¦å‹ã€å¤šè½¦åœº VRP çº¦æŸæä¾›æ•°æ®åŸºç¡€ã€‚

### 6. `routes` / `route_stops` è¡¨ - æ’ç¨‹ç»“æœï¼ˆç»´åº¦å±‚ + äº‹å®å±‚ï¼‰

**`routes` è¡¨**ï¼ˆè·¯çº¿ä¸»è¡¨ï¼‰ï¼š
- `route_code` - è·¯çº¿ç¼–ç ï¼ˆå¦‚ V1-2025-12-04ï¼‰
- `planning_date` - è§„åˆ’æ—¥æœŸ
- `vehicle_id` - å¯¹åº”è½¦è¾†
- `warehouse_id` - å‡ºå‘ä»“åº“
- `total_distance` / `total_pallets` - è·¯çº¿çº§æŒ‡æ ‡
- `status` - planned / executed / cancelled

**`route_stops` è¡¨**ï¼ˆè·¯çº¿ç«™ç‚¹ï¼‰ï¼š
- `route_id` - å¤–é”®ï¼Œå…³è” `routes.id`
- `sequence_no` - åœ¨è·¯çº¿ä¸­çš„é¡ºåº
- `order_id` - å…³è”åˆ°è¢«æœåŠ¡çš„è®¢å•ï¼ˆ`orders.id`ï¼‰
- `arrival_time` / `departure_time` - è®¡åˆ’åˆ°è¾¾/ç¦»å¼€æ—¶é—´
- `distance_from_prev` / `pallets` - ä¸ä¸Šä¸€ä¸ªç‚¹çš„è·ç¦»ã€æœ¬ç‚¹æ‰˜ç›˜æ•°

è¿™ä¸¤å¼ è¡¨ä¸»è¦ç”¨äº**æŒä¹…åŒ– VRP æ±‚è§£ç»“æœ**ï¼Œæ”¯æŒå†å²å›æ”¾å’Œå¯¹æ¯”åˆ†æã€‚

### 7. `planning_orders` è¡¨ - è§„åˆ’è¾“å…¥è¡¨ï¼ˆè§„åˆ’å±‚ï¼‰

**ä½œç”¨**ï¼šä½œä¸ºç®—æ³•å¼•æ“çš„â€œå¹²å‡€è¾“å…¥å±‚â€ï¼Œç»“æ„ä¸ `OrderRequest` æ¥è¿‘ï¼Œé¿å…ç›´æ¥å¯¹æ¥å¤æ‚çš„ä¸šåŠ¡è¡¨ã€‚

**å­—æ®µè¯´æ˜**ï¼š
- `order_id` - ä¸šåŠ¡è®¢å•å·
- `customer_id` / `customer_name` - å®¢æˆ·ä¿¡æ¯ï¼ˆæ—¢å¯ä»¥å…³è”ï¼Œä¹Ÿå¯ä»¥å†—ä½™æ–‡æœ¬ï¼‰
- `rsd` - æ€¥å•æ ‡è¯†
- `location_x` / `location_y` - è§„åˆ’åæ ‡
- `status` - pending / planned / dropped
- `total_weight` / `total_volume` / `pallets_estimated` - é¢„èšåˆçš„è½½é‡ã€ä½“ç§¯ã€æ‰˜ç›˜æ•°

æ¨èåšæ³•ï¼š
- ä»çœŸå® OMS/ERP è¡¨æŒ‰æ‰¹æ¬¡æŠ½å–æ•°æ® â†’ å†™å…¥/æ›´æ–° `planning_orders`
- ç®—æ³•æœåŠ¡åªè¯» `planning_orders`ï¼Œä¿æŒä¸ä¸Šæ¸¸ä¸šåŠ¡è§£è€¦ã€‚

**ç¤ºä¾‹æ•°æ®**ï¼š
```
id | order_id | sku_id | quantity
---|----------|--------|----------
1  | 1        | 1      | 75       (ORD-1000 åŒ…å« 75ä¸ª Tower_Fan_Pilot)
2  | 1        | 2      | 100      (ORD-1000 åŒ…å« 100ä¸ª Air_Fryer_Pro)
3  | 2        | 1      | 60       (ORD-1001 åŒ…å« 60ä¸ª Tower_Fan_Pilot)
4  | 3        | 3      | 50       (ORD-1002 åŒ…å« 50ä¸ª Heater_Solaris)
```

## ğŸ”— å…³ç³»è¯¦è§£

### å…³ç³»ç±»å‹ï¼šå¤šå¯¹å¤šï¼ˆMany-to-Manyï¼‰

**ä¸ºä»€ä¹ˆéœ€è¦ä¸­é—´è¡¨ï¼Ÿ**

åœ¨å…³ç³»å‹æ•°æ®åº“ä¸­ï¼Œå¤šå¯¹å¤šå…³ç³»ä¸èƒ½ç›´æ¥å»ºç«‹ï¼Œå¿…é¡»é€šè¿‡ä¸­é—´è¡¨ï¼ˆå…³è”è¡¨ï¼‰æ¥å®ç°ï¼š

- **ä¸€ä¸ªè®¢å•** å¯ä»¥åŒ…å« **å¤šä¸ªSKU**ï¼ˆå¦‚è®¢å•ORD-1000åŒ…å«Tower_Fan_Pilotå’ŒAir_Fryer_Proï¼‰
- **ä¸€ä¸ªSKU** å¯ä»¥å‡ºç°åœ¨ **å¤šä¸ªè®¢å•** ä¸­ï¼ˆå¦‚Tower_Fan_Pilotå‡ºç°åœ¨ORD-1000å’ŒORD-1001ä¸­ï¼‰

### å¤–é”®çº¦æŸ

#### 1. `order_items.order_id` â†’ `orders.id`
- **å…³ç³»**ï¼šå¤šå¯¹ä¸€ï¼ˆå¤šä¸ªè®¢å•æ˜ç»†å±äºä¸€ä¸ªè®¢å•ï¼‰
- **çº¦æŸ**ï¼š`ON DELETE CASCADE` - åˆ é™¤è®¢å•æ—¶ï¼Œè‡ªåŠ¨åˆ é™¤è¯¥è®¢å•çš„æ‰€æœ‰æ˜ç»†
- **å«ä¹‰**ï¼šæ¯ä¸ªè®¢å•æ˜ç»†å¿…é¡»å±äºä¸€ä¸ªå­˜åœ¨çš„è®¢å•

#### 2. `order_items.sku_id` â†’ `skus.id`
- **å…³ç³»**ï¼šå¤šå¯¹ä¸€ï¼ˆå¤šä¸ªè®¢å•æ˜ç»†å¼•ç”¨åŒä¸€ä¸ªSKUï¼‰
- **çº¦æŸ**ï¼š`ON DELETE CASCADE` - åˆ é™¤SKUæ—¶ï¼Œè‡ªåŠ¨åˆ é™¤æ‰€æœ‰å¼•ç”¨è¯¥SKUçš„è®¢å•æ˜ç»†
- **å«ä¹‰**ï¼šæ¯ä¸ªè®¢å•æ˜ç»†å¿…é¡»å¼•ç”¨ä¸€ä¸ªå­˜åœ¨çš„SKU

### SQLAlchemy ORM å…³ç³»å®šä¹‰

```python
# orders è¡¨
items = relationship("OrderItem", back_populates="order", cascade="all, delete-orphan")
# å«ä¹‰ï¼šä¸€ä¸ªè®¢å•å¯ä»¥æœ‰å¤šä¸ªè®¢å•æ˜ç»†ï¼Œåˆ é™¤è®¢å•æ—¶çº§è”åˆ é™¤æ˜ç»†

# skus è¡¨
order_items = relationship("OrderItem", back_populates="sku")
# å«ä¹‰ï¼šä¸€ä¸ªSKUå¯ä»¥å‡ºç°åœ¨å¤šä¸ªè®¢å•æ˜ç»†ä¸­

# order_items è¡¨
order = relationship("Order", back_populates="items")
sku = relationship("SKU", back_populates="order_items")
# å«ä¹‰ï¼šæ¯ä¸ªè®¢å•æ˜ç»†å±äºä¸€ä¸ªè®¢å•ï¼Œå¼•ç”¨ä¸€ä¸ªSKU
```

## ğŸ“ å®é™…ä¸šåŠ¡åœºæ™¯ç¤ºä¾‹

### åœºæ™¯ï¼šè®¢å• ORD-1000 åŒ…å«ä¸¤ç§å•†å“

**1. è®¢å•ä¸»è¡¨ï¼ˆordersï¼‰**
```
id: 1
order_id: "ORD-1000"
customer: "Walmart_DC_0"
rsd: 0 (æ€¥å•)
location_x: 45
location_y: 55
status: "pending"
```

**2. è®¢å•æ˜ç»†è¡¨ï¼ˆorder_itemsï¼‰**
```
æ˜ç»†1:
  order_id: 1 (å…³è”åˆ° orders.id=1)
  sku_id: 1 (å…³è”åˆ° skus.id=1, å³ Tower_Fan_Pilot)
  quantity: 75

æ˜ç»†2:
  order_id: 1 (å…³è”åˆ° orders.id=1)
  sku_id: 2 (å…³è”åˆ° skus.id=2, å³ Air_Fryer_Pro)
  quantity: 100
```

**3. SKUä¿¡æ¯è¡¨ï¼ˆskusï¼‰**
```
SKU1:
  id: 1
  name: "Tower_Fan_Pilot"
  length: 110, width: 30, height: 30, weight: 8.5

SKU2:
  id: 2
  name: "Air_Fryer_Pro"
  length: 40, width: 35, height: 35, weight: 6.0
```

## ğŸ” å¸¸ç”¨æŸ¥è¯¢ç¤ºä¾‹

### 1. æŸ¥çœ‹è®¢å•çš„å®Œæ•´ä¿¡æ¯ï¼ˆåŒ…å«æ‰€æœ‰SKUï¼‰

```sql
SELECT 
    o.order_id,
    o.customer,
    o.rsd,
    s.name as sku_name,
    s.length,
    s.width,
    s.height,
    s.weight,
    oi.quantity
FROM orders o
JOIN order_items oi ON o.id = oi.order_id
JOIN skus s ON oi.sku_id = s.id
WHERE o.order_id = 'ORD-1000';
```

**ç»“æœ**ï¼š
```
order_id | customer      | rsd | sku_name        | quantity
---------|---------------|-----|-----------------|----------
ORD-1000 | Walmart_DC_0 | 0   | Tower_Fan_Pilot | 75
ORD-1000 | Walmart_DC_0 | 0   | Air_Fryer_Pro   | 100
```

### 2. ç»Ÿè®¡æ¯ä¸ªè®¢å•çš„å•†å“ç§ç±»æ•°

```sql
SELECT 
    o.order_id,
    o.customer,
    COUNT(DISTINCT oi.sku_id) as sku_types,
    SUM(oi.quantity) as total_quantity
FROM orders o
LEFT JOIN order_items oi ON o.id = oi.order_id
GROUP BY o.id, o.order_id, o.customer;
```

### 3. æŸ¥æ‰¾åŒ…å«ç‰¹å®šSKUçš„æ‰€æœ‰è®¢å•

```sql
SELECT 
    o.order_id,
    o.customer,
    oi.quantity
FROM orders o
JOIN order_items oi ON o.id = oi.order_id
JOIN skus s ON oi.sku_id = s.id
WHERE s.name = 'Tower_Fan_Pilot';
```

### 4. è®¡ç®—è®¢å•çš„æ€»é‡é‡å’Œä½“ç§¯

```sql
SELECT 
    o.order_id,
    o.customer,
    SUM(s.weight * oi.quantity) as total_weight,
    SUM(s.length * s.width * s.height * oi.quantity) as total_volume
FROM orders o
JOIN order_items oi ON o.id = oi.order_id
JOIN skus s ON oi.sku_id = s.id
GROUP BY o.id, o.order_id, o.customer;
```

## âš ï¸ æ•°æ®å®Œæ•´æ€§çº¦æŸ

### 1. å¤–é”®çº¦æŸ
- ä¸èƒ½æ’å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„ `order_id` åˆ° `order_items` è¡¨
- ä¸èƒ½æ’å…¥ä¸€ä¸ªä¸å­˜åœ¨çš„ `sku_id` åˆ° `order_items` è¡¨

### 2. çº§è”åˆ é™¤
- åˆ é™¤è®¢å•æ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤è¯¥è®¢å•çš„æ‰€æœ‰æ˜ç»†
- åˆ é™¤SKUæ—¶ï¼Œä¼šè‡ªåŠ¨åˆ é™¤æ‰€æœ‰å¼•ç”¨è¯¥SKUçš„è®¢å•æ˜ç»†

### 3. å”¯ä¸€æ€§çº¦æŸ
- `skus.name` å¿…é¡»å”¯ä¸€
- `orders.order_id` å¿…é¡»å”¯ä¸€

## ğŸ’¡ è®¾è®¡ä¼˜åŠ¿

1. **æ•°æ®è§„èŒƒåŒ–**ï¼šé¿å…æ•°æ®å†—ä½™ï¼ŒSKUä¿¡æ¯åªå­˜å‚¨ä¸€æ¬¡
2. **çµæ´»æ€§**ï¼šä¸€ä¸ªè®¢å•å¯ä»¥åŒ…å«ä»»æ„æ•°é‡å’Œç§ç±»çš„SKU
3. **å¯æ‰©å±•æ€§**ï¼šæ–°å¢SKUæˆ–è®¢å•éƒ½å¾ˆæ–¹ä¾¿
4. **æ•°æ®ä¸€è‡´æ€§**ï¼šé€šè¿‡å¤–é”®çº¦æŸä¿è¯æ•°æ®å®Œæ•´æ€§
5. **æŸ¥è¯¢æ•ˆç‡**ï¼šé€šè¿‡ç´¢å¼•ä¼˜åŒ–å¸¸ç”¨æŸ¥è¯¢

## ğŸ¯ åœ¨ä»£ç ä¸­çš„ä½¿ç”¨

### é€šè¿‡ ORM æŸ¥è¯¢è®¢å•åŠå…¶æ˜ç»†

```python
from app.database import SessionLocal
from app.db_models import Order, OrderItem, SKU

db = SessionLocal()

# æŸ¥è¯¢è®¢å•åŠå…¶æ‰€æœ‰æ˜ç»†
order = db.query(Order).filter(Order.order_id == 'ORD-1000').first()

# é€šè¿‡å…³ç³»è®¿é—®è®¢å•æ˜ç»†
for item in order.items:
    print(f"SKU: {item.sku.name}, æ•°é‡: {item.quantity}")

# é€šè¿‡å…³ç³»è®¿é—®SKUä¿¡æ¯
sku = db.query(SKU).filter(SKU.name == 'Tower_Fan_Pilot').first()

# æŸ¥çœ‹å“ªäº›è®¢å•åŒ…å«è¿™ä¸ªSKU
for item in sku.order_items:
    print(f"è®¢å•: {item.order.order_id}, æ•°é‡: {item.quantity}")
```

## ğŸ“Š å…³ç³»å›¾æ€»ç»“

```
orders (1) â”€â”€< (N) order_items (N) >â”€â”€ (1) skus
   â”‚                    â”‚                    â”‚
   â”‚                    â”‚                    â”‚
è®¢å•ä¸»ä¿¡æ¯          å…³è”è¡¨ï¼ˆæ•°é‡ï¼‰        SKUåŸºç¡€ä¿¡æ¯
```

**å…³é”®ç‚¹**ï¼š
- `order_items` æ˜¯ä¸­é—´è¡¨ï¼Œè¿æ¥ `orders` å’Œ `skus`
- é€šè¿‡ `order_items` è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š
  - æ¯ä¸ªè®¢å•åŒ…å«å“ªäº›SKU
  - æ¯ä¸ªSKUå‡ºç°åœ¨å“ªäº›è®¢å•ä¸­
  - æ¯ä¸ªè®¢å•ä¸­æ¯ä¸ªSKUçš„æ•°é‡

